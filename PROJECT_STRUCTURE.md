# Battle City Pro - პროექტის სტრუქტურა

## პროექტის აღწერა
**Battle City Pro** არის რეტრო-სტილის ტანკების ბრძოლის თამაში ვებ-აპლიკაციის სახით.
მოიცავს ტურნირის სისტემას 32 მოთამაშისთვის და Solana ბლოკჩეინის ინტეგრაციას.

---

## ფოლდერების სტრუქტურა

```
C:\dev\tanks\
│
├── components/                 # React კომპონენტები
│   ├── GameCanvas.tsx         # თამაშის ძრავი და რენდერი
│   ├── Sidebar.tsx            # გვერდითი პანელი (ქულები, ჯანმრთელობა)
│   ├── Lobby.tsx              # ლობი და რეგისტრაცია
│   ├── TournamentBracket.tsx  # ტურნირის ბრეკეტი
│   └── Celebration.tsx        # გამარჯვების ანიმაცია
│
├── services/                   # სერვისები
│   └── SoundManager.ts        # ხმის სისტემა
│
├── App.tsx                     # მთავარი კომპონენტი
├── index.tsx                   # React entry point
├── index.html                  # HTML შაბლონი
├── types.ts                    # TypeScript ტიპები
├── constants.ts                # კონსტანტები და საწყისი რუკა
├── geminiService.ts            # Google Gemini AI ინტეგრაცია
├── package.json                # NPM დამოკიდებულებები
├── tsconfig.json               # TypeScript კონფიგურაცია
├── vite.config.ts              # Vite კონფიგურაცია
└── .env.local                  # გარემოს ცვლადები (API keys)
```

---

## ფაილების დეტალური აღწერა

### მთავარი ფაილები

| ფაილი | დანიშნულება |
|-------|-------------|
| `App.tsx` | აპლიკაციის მთავარი კომპონენტი, state management |
| `index.tsx` | React-ის entry point |
| `index.html` | HTML შაბლონი, CDN ბმულები |
| `types.ts` | TypeScript ტიპები და ინტერფეისები |
| `constants.ts` | თამაშის კონსტანტები (ზომები, ფერები, რუკა) |

### კომპონენტები (`/components`)

| კომპონენტი | დანიშნულება | მთავარი ფუნქციები |
|------------|-------------|-------------------|
| `GameCanvas.tsx` | თამაშის ძრავი | Canvas რენდერი, game loop, კოლიზიები |
| `Sidebar.tsx` | UI პანელი | ქულები, HP, სიცოცხლეები |
| `Lobby.tsx` | ლობი | ტანკის არჩევა, რეგისტრაცია |
| `TournamentBracket.tsx` | ბრეკეტი | 32 მოთამაშის ტურნირი |
| `Celebration.tsx` | ზეიმი | ფეიერვერკის ეფექტები |

### სერვისები (`/services`)

| სერვისი | დანიშნულება |
|---------|-------------|
| `SoundManager.ts` | Web Audio API, რეტრო ხმები |
| `geminiService.ts` | AI რუკების გენერაცია |

---

## ტექნოლოგიები

| კატეგორია | ტექნოლოგია |
|-----------|------------|
| Frontend | React 19.2.4 |
| ენა | TypeScript 5.8.2 |
| Bundler | Vite 6.2.0 |
| სტილები | Tailwind CSS |
| რენდერი | HTML5 Canvas 2D |
| ხმა | Web Audio API |
| AI | Google Gemini API |

---

## თამაშის მექანიკა

### რუკის ზომები
- **Grid**: 13x13 უჯრა
- **Tile ზომა**: 40px
- **Canvas**: 520x520px

### უჯრების ტიპები (`TileType` enum)

| კოდი | ტიპი | აღწერა |
|------|------|--------|
| 0 | EMPTY | ცარიელი |
| 1 | BRICK | აგური (ნადგურდება) |
| 2 | STEEL | ფოლადი (მყარი) |
| 3 | BUSH | ბუჩქი (გამჭვირვალე) |
| 4 | WATER | წყალი (დაბრკოლება) |
| 5 | CRATE | ყუთი (power-up) |
| 6 | SPAWN | spawn point |
| 9 | PLAYER_BASE | მოთამაშის ბაზა |
| 13 | ENEMY_BASE | მტრის ბაზა |

### ტანკის პრესეტები (5 ვარიანტი)

| # | სახელი | HP | სიჩქარე | თავისებურება |
|---|--------|----|---------|--------------|
| 1 | ST-1 BALANCED | 6 | ნორმალური | დაბალანსებული |
| 2 | HV-7 HEAVY | 10 | -20% | მძიმე ჯავშანი |
| 3 | LT-3 SCOUT | 4 | +30% | სწრაფი |
| 4 | SN-5 SNIPER | 5 | ნორმალური | სწრაფი ტყვიები |
| 5 | VT-X ELITE | 7 | +15% | ელიტური |

### Power-ups

| ტიპი | ეფექტი |
|------|--------|
| Star | ტყვიის დონის გაზრდა (1-4) |
| Armor | ფარი (600 ფრეიმი) |
| Speed | დროებითი სიჩქარე |

### ტყვიის დონეები

| დონე | ფერი | სიძლიერე |
|------|------|----------|
| 1 | თეთრი | სტანდარტი |
| 2 | ციანი | გაძლიერებული |
| 3 | ნარინჯისფერი | ძლიერი |
| 4 | იისფერი | მაქსიმალური |

---

## ტურნირის სისტემა

### სტრუქტურა (32 მოთამაშე)

```
Round 32 (16 მატჩი)
    ↓
Round 16 (8 მატჩი)
    ↓
Quarterfinals (4 მატჩი)
    ↓
Semifinals (2 მატჩი)
    ↓
Finals (1 მატჩი)
```

### პრიზები (10 SOL)
- **1 ადგილი**: 40% (4 SOL)
- **2 ადგილი**: 30% (3 SOL)
- **3 ადგილი**: 30% (3 SOL)

---

## არქიტექტურის დიაგრამა

```
┌─────────────────────────────────────────────────────────┐
│                      App.tsx                            │
│              (State Management Hub)                     │
│  ┌─────────────────────────────────────────────────┐   │
│  │ States: gameActive, inTournament, inLobby,      │   │
│  │         tournament, map, score, lives, health   │   │
│  └─────────────────────────────────────────────────┘   │
└────────────────────────┬────────────────────────────────┘
                         │
    ┌────────────────────┼────────────────────┐
    │                    │                    │
    ▼                    ▼                    ▼
┌────────────┐    ┌────────────┐    ┌─────────────────┐
│ Lobby.tsx  │    │ GameCanvas │    │ TournamentBracket│
│            │    │   .tsx     │    │     .tsx        │
│ - ტანკის   │    │            │    │                 │
│   არჩევა   │    │ - Game Loop│    │ - ბრეკეტის     │
│ - რეგისტრ. │    │ - რენდერი  │    │   ვიზუალიზაცია │
└────────────┘    │ - კოლიზიები│    └─────────────────┘
                  │ - ფიზიკა   │
                  └─────┬──────┘
                        │
          ┌─────────────┼─────────────┐
          │             │             │
          ▼             ▼             ▼
    ┌──────────┐  ┌──────────┐  ┌──────────────┐
    │ Sidebar  │  │ Sound    │  │ Celebration  │
    │  .tsx    │  │ Manager  │  │    .tsx      │
    │          │  │   .ts    │  │              │
    │ - ქულები │  │ - ხმები  │  │ - ფეიერვერკი│
    │ - HP/Lives│ │ - მუსიკა │  │ - პარტიკლები│
    └──────────┘  └──────────┘  └──────────────┘
```

---

## მონაცემთა ნაკადი (Data Flow)

```
მომხმარებლის მოქმედება
        │
        ▼
    App.tsx (state განახლება)
        │
        ├──▶ GameCanvas (თამაშის ლოგიკა)
        │         │
        │         ├──▶ Entity-ების განახლება
        │         ├──▶ კოლიზიების შემოწმება
        │         ├──▶ რენდერი Canvas-ზე
        │         └──▶ SoundManager (ხმები)
        │
        ├──▶ Sidebar (UI განახლება)
        │
        └──▶ Callbacks:
              - onVictory()
              - onGameOver()
              - onScoreUpdate()
```

---

## თამაშის ნაკადი (Game Flow)

```
1. მთავარი მენიუ
        │
        ▼
2. Solana Wallet-ის დაკავშირება
        │
        ▼
3. ლობი (Lobby)
   ├── სახელის შეყვანა
   ├── ტანკის არჩევა (1-5)
   └── მოთამაშეების მოლოდინი (32)
        │
        ▼
4. ტურნირი იწყება
        │
        ▼
5. მატჩი (GameCanvas)
   ├── მოთამაშე vs AI
   ├── გამარჯვება → შემდეგი რაუნდი
   └── წაგება → ტურნირი გრძელდება AI-სთვის
        │
        ▼
6. ფინალი
        │
        ▼
7. პოდიუმი & ჯილდოები
```

---

## მართვა (Controls)

| კლავიში | მოქმედება |
|---------|-----------|
| ↑ ↓ ← → | მოძრაობა |
| Space | გასროლა |
| M | ხმის გამორთვა |

---

## გაშვება

```bash
# დამოკიდებულებების ინსტალაცია
npm install

# Development სერვერის გაშვება
npm run dev

# Build
npm run build
```

სერვერი გაეშვება: `http://localhost:3000`

---

## გარემოს ცვლადები (.env.local)

```env
VITE_GEMINI_API_KEY=your_gemini_api_key_here
```

---

## ხშირად საჭირო ფაილები

### სწრაფი რედაქტირებისთვის:

| რა გინდა შეცვალო | ფაილი | ხაზები |
|------------------|-------|--------|
| თამაშის ლოგიკა | `components/GameCanvas.tsx` | 1-500+ |
| ტანკის პარამეტრები | `components/Lobby.tsx` | tankPresets array |
| რუკის ზომა/ტაილები | `constants.ts` | GRID_SIZE, TILE_SIZE |
| ფერები | `constants.ts` | COLORS object |
| ხმები | `services/SoundManager.ts` | play* methods |
| ტურნირის ლოგიკა | `App.tsx` | tournament state |
| AI რუკის გენერაცია | `geminiService.ts` | generateMapWithGemini |

---

## Entity ინტერფეისი

```typescript
interface Entity {
  x: number;           // X პოზიცია
  y: number;           // Y პოზიცია
  width: number;       // სიგანე
  height: number;      // სიმაღლე
  direction: Direction; // მიმართულება (UP/DOWN/LEFT/RIGHT)
  speed: number;       // სიჩქარე
  hp: number;          // ჯანმრთელობა
  maxHp: number;       // მაქს. ჯანმრთელობა
  bulletLevel?: number; // ტყვიის დონე (1-4)
  shieldTimer?: number; // ფარის დრო
  color?: string;      // ფერი
}
```

---

## რჩევები მუშაობისთვის

1. **თამაშის ძრავის ცვლილებები** - `GameCanvas.tsx`-ში `update()` და `draw()` ფუნქციები
2. **ახალი power-up დამატება** - `GameCanvas.tsx`-ში `spawnPowerUp()` და `checkPowerUpCollision()`
3. **ახალი ტანკის დამატება** - `Lobby.tsx`-ში `tankPresets` მასივში
4. **ხმის ეფექტი** - `SoundManager.ts`-ში ახალი method
5. **UI ცვლილება** - Tailwind CSS კლასები კომპონენტებში

---

*დოკუმენტი შექმნილია: 2026-01-29*
